## Потенциальные проблемы грамматик и их решение средствами ANTLR4

### 1. Приоритет операторов:
- Проблема: бинарные операции одинакового уровня (например, ```+``` и ```-```) обрабатываются не по математическим правилам
- Диагностика: выражение ```1 + 2 * 3``` интерпретируется как ```(1 + 2) * 3```.
- Решение в ANTLR4: расположить правила в иерархии, где каждому уровню приоритета соответствует свое правило:

```antlr
expr : expr '+' term 
    | expr '-' term
    | term
    ;
term : term '*' factor
    | term '/' factor
    | factor
    ;
factor : INT
    | '(' expr ')'
    ;
```

<br>

### 2. Левая рекурсия
- Проблема: леворекурсивные правила вызывают бесконечную рекурсию в нисходящих парсерах
- Грамматика:

```antlr
expr = expr '+' INT
 | INT
 ;
```

- Решение в ANTLR4: парсер явно поддерживает левую рекурсию. Данная грамматика будет работать без каких-либо изменений

<br>

### 3. Левоассоциативные операции
- Проблема: праворекурсивная грамматика приводит к правой ассоциативности. Выражение ```5 - 3 - 1``` разбирается как ```(5 - (3 - 1))```, что равно ```3```, а не ```1```.
- Грамматика:

```antlr
expr : INT '-' expr
 | INT
 ;
```

- Решение в ANTLR4: использовать левую рекурсию Леворекурсивное правило автоматически обеспечивает левую ассоциативность.

<br>

### 4. Правоассоциативные операторы 
- Проблема: оператор возведения в степень (```^```) должен быть правоассоциативным: ```2^3^2``` = ```2^(3^2)```.
- Решенеие в ANTLR4: праворекурсивное правило для целевого оператора:
```antlr
power : primary ('^' power)? ;
expr  : power
    | expr '+' expr
    | expr '*' expr
    ;
```

<br>

### 5. Неоднозначность правил
- Проблема: конфликт между правилами для идентификаторов (переменная ```a```) и вызова функции ```a()```.
- Проблемная грамматика:
```antlr
expression : ID
       | ID '(' ')'
       ;
```
- Диагностика: неоднозначный разбор выражения ```f(5)```: парсер не может выбрать между правилами _variable_ и _functionCall_.
- Решение: явно разделить правила, поставив более специфичное правило (вызов функции) **выше**:
```antlr
expr : ID '(' expr? ')'   # FunctionCall  // Сначала пробуем как вызов
     | ID                 # Variable      // Иначе как переменная
     | NUMBER             # Number
     ;
```

<br>

### 6. Висячий else от if
- Проблема: неясно к какому ```if``` относить ```else```, если "вложенное" условие записано, не разграничиваясь скобками:
```
if (a) DoSomethin1(); if (b) DoSomethin2(); else DoSomethin3(); // DoSomethin3 то когда выполнится?
``` 
- Решение: сделаем, как в C++: в таких условиях любой вложенности висячий ```else``` будем относить к ближайшему ```if```










